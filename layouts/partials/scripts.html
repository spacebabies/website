{{ $ma := resources.Get "js/main.js" -}}
{{ $bundle := slice (resources.Get "js/library/feather.js") -}}
{{ $bundle = $bundle | append (resources.Get "js/library/photoswipe.js") -}}
{{ $bundle = $bundle | append (resources.Get "js/library/photoswipe-ui-default.js") -}}
{{ $bundle = $bundle | append (resources.Get "js/library/sticky-header.js") -}}
{{ $bundle = $bundle | append (resources.Get "js/main.js") -}}
{{ $js := $bundle | resources.Concat "js/main.js" | minify | fingerprint -}}
<script type="text/javascript" src="{{ $js.RelPermalink }}" integrity="{{ $js.Data.Integrity }}"></script>

{{ $esopt := (dict
    "minify" true
    "targetPath" "js/app.js"
    "target" "es2017") -}}
{{ $app := resources.Get "js/app.js" | js.Build $esopt | fingerprint }}
<script type="text/javascript" src="{{ $app.RelPermalink }}" integrity="{{ $app.Data.Integrity }}"></script>

<script type="application/ld+json">
  {{ $address := dict
    "@type" "PostalAddress"
    "streetAddress" .Site.Params.streetAddress
    "addressLocality" .Site.Params.addressLocality
    "postalCode" .Site.Params.postalCode
    "addressCountry" .Site.Params.addressCountry
  -}}
  {{ dict
    "@context" "https://schema.org"
    "@type" "Organization"
    "@id" (ref . "/")
    "name" .Site.Title
    "description" .Site.Params.description
    "url" (ref . "/")
    "location" $address
    "publicAccess" false
    "logo" ($.Scratch.Get "logo").Permalink
    "priceRange" "$$$$"
    "vatID" .Site.Data.homepage.contact.vatID.number
    "email" .Site.Params.email | jsonify (dict "indent" "\t") | safeJS }}
  </script>
