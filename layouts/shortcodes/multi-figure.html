<figure>
    <picture>
        {{ range .Page.Resources.Match (add (.Get "src") ".*") }}
        <source type="{{ .MediaType }}" src="{{ .RelPermalink }}">
        {{ end -}}

        {{ $loading := (.Get "loading") }}
        {{ with .Page.Resources.GetMatch (add (.Get "src") ".*") }}
        <img
            {{ with $loading }} loading="{{ . }}" {{ end }}
            src="{{ .RelPermalink }}"
            alt="{{ .Title }}">
        {{ end -}}
    </picture>
    <figcaption>{{ .Get "caption" }}</figcaption>
</figure>